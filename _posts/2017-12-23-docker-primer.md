---
layout: post
title: Docker å…¥é—¨
date: 2017-12-23
---

## Docker æ˜¯ä»€ä¹ˆï¼Ÿ

Docker æ˜¯åŸºäº Go è¯­è¨€å®ç°çš„å¼€æºå®¹å™¨é¡¹ç›®ï¼Œè¯ç”Ÿäº 2013 å¹´ã€‚

ç›®å‰å·²æœ‰å¤šä¸ªç›¸å…³é¡¹ç›®ï¼ŒåŒ…æ‹¬ Docker ä¸‰å‰‘å®¢ï¼ˆMachine, Compose, Swarmï¼‰ã€Kubernetes ç­‰ã€‚

Docker çš„æ„æƒ³æ˜¯è¦å®ç°â€œBuild, Ship and Run Any App, Anywhereâ€ï¼Œå³é€šè¿‡å¯¹åº”ç”¨çš„å°è£…ã€åˆ†å‘ã€éƒ¨ç½²ã€è¿è¡Œç”Ÿå‘½å‘¨æœŸè¿›è¡Œç®¡ç†ï¼Œè¾¾åˆ°åº”ç”¨ç»„ä»¶â€œä¸€æ¬¡å°è£…ï¼Œåˆ°å¤„è¿è¡Œâ€çš„ç›®çš„ã€‚

Docker ä½¿ç”¨ Linux å®¹å™¨ï¼ˆLinux Containers, LXCï¼‰æŠ€æœ¯ã€‚æ—©æœŸçš„ Docker ä»£ç å®ç°ç›´æ¥åŸºäº LXCã€‚è‡ª 0.9 ç‰ˆæœ¬å¼€å§‹ï¼ŒDocker å¼€å‘äº† `libcontainer` é¡¹ç›®ï¼Œä½œä¸ºæ›´å¹¿æ³›çš„å®¹å™¨é©±åŠ¨å®ç°ï¼Œä»è€Œæ›¿æ¢æ‰ LXC å®ç°ã€‚

ç®€å•çš„è®²ï¼Œå¯ä»¥æŠŠ Docker å®¹å™¨ç†è§£ä¸ºä¸€ç§è½»é‡çº§çš„æ²™ç›’ï¼ˆsandboxï¼‰ã€‚

## ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ Dockerï¼Ÿ

Docker é¡¹ç›®å‘èµ·äººå…¼å…¬å¸ CTO *Solomon Hykes* æ›¾è®¤ä¸ºï¼ŒDocker åœ¨æ­£ç¡®çš„åœ°ç‚¹ã€æ­£ç¡®çš„æ—¶é—´é¡ºåº”äº†æ­£ç¡®çš„è¶‹åŠ¿ --- å¦‚ä½•æ­£ç¡®çš„æ„å»ºåº”ç”¨ã€‚

å¿«é€Ÿåˆ†å‘å’Œéƒ¨ç½²ï¼Œè¿™æ­£æ˜¯ Docker æ‰€èƒ½å¤Ÿæä¾›çš„æœ€å¤§ä¼˜åŠ¿ã€‚

ä½¿ç”¨ Dockerï¼Œå¼€å‘äººå‘˜å¯ä»¥ä½¿ç”¨é•œåƒå¿«é€Ÿæ„å»ºä¸€å¥—æ ‡å‡†çš„å¼€å‘ç¯å¢ƒï¼›å¼€å‘å®Œæˆä¹‹åï¼Œæµ‹è¯•å’Œè¿ç»´äººå‘˜å¯ä»¥ä½¿ç”¨å®Œå…¨ç›¸åŒçš„ç¯å¢ƒæ¥éƒ¨ç½²ä»£ç ã€‚

æ›´æ–°ç®¡ç†æ›´ç®€å•ã€‚ä½¿ç”¨ Dockfileï¼Œåªéœ€è¦ä¿®æ”¹é…ç½®ï¼Œå°±å¯ä»¥æ›¿ä»£ä»¥å¾€å¤§é‡çš„æ›´æ–°å·¥ä½œã€‚

## ä¸‰å¤§æ ¸å¿ƒæ¦‚å¿µ

Docker çš„å¤§éƒ¨åˆ†æ“ä½œéƒ½å›´ç»•ç€å®ƒçš„ä¸‰å¤§æ ¸å¿ƒæ¦‚å¿µ --- é•œåƒï¼ˆImageï¼‰ã€å®¹å™¨ï¼ˆContainerï¼‰å’Œä»“åº“ï¼ˆRepositoryï¼‰è€Œå±•å¼€ã€‚æ‰€ä»¥ä¸€å®šè¦æ­£ç¡®ç†è§£è¿™ä¸‰ä¸ªæ¦‚å¿µã€‚

### é•œåƒ

å¯ä»¥æŠŠé•œåƒç†è§£ä¸ºä¸€ä¸ªåªè¯»æ¨¡æ¿ï¼Œå®ƒæ˜¯åˆ›å»º Docker å®¹å™¨çš„åŸºç¡€ã€‚å¯ä»¥æŠŠå®ƒæ¯”ä½œå…‰ç›˜ğŸ’¿é•œåƒã€‚

### å®¹å™¨

å®¹å™¨ç±»ä¼¼äºä¸€ä¸ªè½»é‡çº§æ²™ç®±ï¼Œç”¨æ¥è¿è¡Œå’Œéš”ç¦»åº”ç”¨ã€‚å¯ä»¥æŠŠå®¹å™¨çœ‹ä½œæ˜¯ä¸€ä¸ªç®€æ˜“ç‰ˆçš„ Linux ç³»ç»Ÿç¯å¢ƒã€‚

é•œåƒæ˜¯åªè¯»çš„ï¼Œå®¹å™¨ä»é•œåƒå¯åŠ¨æ—¶ï¼Œä¼šåœ¨é•œåƒä¹‹ä¸Šåˆ›å»ºä¸€ä¸ªå¯å†™å±‚ã€‚

### ä»“åº“

Docker ä»“åº“ç±»ä¼¼ä»£ç ä»“åº“ï¼Œç”¨äºé›†ä¸­å­˜æ”¾é•œåƒæ–‡ä»¶ã€‚å°±åƒå…‰ç›˜è´§æ¶ä¸€æ ·ã€‚

ä¸è¦æŠŠä»“åº“å’Œæ³¨å†ŒæœåŠ¡å™¨ï¼ˆRegistryï¼‰æ··æ·†ã€‚æ³¨å†ŒæœåŠ¡å™¨æ˜¯å­˜æ”¾ä»“åº“çš„åœ°æ–¹ã€‚æ¯ä¸ªä»“åº“é›†ä¸­å­˜æ”¾æŸä¸€ç±»é•œåƒï¼Œé€šè¿‡ä¸åŒçš„æ ‡ç­¾ï¼ˆtagï¼‰åŒºåˆ†ã€‚

ä»“åº“å¯ä»¥åˆ†ä¸ºå…¬å¼€ä»“åº“å’Œç§æœ‰ä»“åº“ã€‚ç›®å‰æœ€å¤§çš„å…¬å¼€ä»“åº“æ˜¯å®˜æ–¹çš„ [Docker Hub][hub]ã€‚

## å®‰è£…

Docker for Mac æ˜¯ä¸€æ¬¾ Docker ç¤¾åŒºç‰ˆåº”ç”¨ã€‚å®ƒçš„å®‰è£…åŒ…å›Šæ‹¬äº† Mac è¿è¡Œ Docker çš„æ‰€æœ‰ä¸œè¥¿ã€‚

åœ¨å®˜ç½‘[ä¸‹è½½é¡µé¢][install-docker-mac]ä¸‹è½½å®‰è£…å³å¯ã€‚

éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸï¼Œå¯ä»¥æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š

```sh
$ docker version

Client:
 Version:	17.12.0-ce
 API version:	1.35
 Go version:	go1.9.2
 Git commit:	c97c6d6
 Built:	Wed Dec 27 20:03:51 2017
 OS/Arch:	darwin/amd64

Server:
 Engine:
  Version:	17.12.0-ce
  API version:	1.35 (minimum version 1.12)
  Go version:	go1.9.2
  Git commit:	c97c6d6
  Built:	Wed Dec 27 20:12:29 2017
  OS/Arch:	linux/amd64
  Experimental:	true
```

è‹¥èƒ½å‡ºç° `Client` å’Œ `Server` ä¿¡æ¯ï¼Œåˆ™è¯´æ˜å®‰è£…æˆåŠŸã€‚

ä¸‹é¢å¯åŠ¨ä¸€ä¸ª nginx å®¹å™¨ï¼Œæ£€æŸ¥èƒ½æ­£ç¡®è·å–é•œåƒå¹¶è¿è¡Œï¼š

```sh
# --detach, -d      åå°è¿è¡Œå®¹å™¨ï¼Œå¹¶æ‰“å°å®¹å™¨ ID
# --publish, -p     å°†å®¹å™¨ç«¯å£å‘å¸ƒåˆ°ä¸»æœºï¼ˆhostï¼‰
# --name            ç»™å®¹å™¨ä¸€ä¸ªåç§°
$ docker run -d -p 80:80 --name webserver nginx
```

> å„å‚æ•°å…·ä½“å«ä¹‰å¯ä»¥å‚è€ƒ[æ–‡æ¡£][cli-run]ã€‚

ç„¶åä½¿ç”¨ [`docker ps`][cli-ps] æŸ¥çœ‹å½“å‰è¿è¡Œçš„å®¹å™¨ï¼š

```sh
$ docker ps

CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                NAMES
08f00d7e9e3a        nginx               "nginx -g 'daemon ofâ€¦"   2 minutes ago       Up 2 minutes        0.0.0.0:80->80/tcp   webserver
```

## ä½¿ç”¨ Docker é•œåƒ

### è·å–é•œåƒ

å¯ä»¥ä½¿ç”¨ `docker pull` å‘½ä»¤ç›´æ¥ä» Docker Hub é•œåƒæºä¸‹è½½é•œåƒã€‚è¯¥å‘½ä»¤çš„æ ¼å¼ä¸º `docker pull [OPTIONS] NAME[:TAG|@DIGEST]`ã€‚å…¶ä¸­ï¼Œ`NAME` æ˜¯é•œåƒä»“åº“çš„åç§°ï¼Œ`TAG` æ˜¯é•œåƒçš„æ ‡ç­¾ï¼ˆé€šå¸¸è¡¨ç¤ºç‰ˆæœ¬ä¿¡æ¯ï¼‰ã€‚

ä¾‹å¦‚è·å–ä¸€ä¸ª Ubuntu 14.04 ç³»ç»Ÿçš„åŸºç¡€é•œåƒå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š

```sh
$ docker pull ubuntu:14.04
```

é•œåƒæ–‡ä»¶ä¸€èˆ¬ç”±è‹¥å¹²å±‚ï¼ˆlayerï¼‰ç»„æˆã€‚

ï¼ˆæœªå®Œå¾…ç»­ã€‚ã€‚ã€‚ï¼‰

## REF

- [Docker æŠ€æœ¯å…¥é—¨ä¸å®æˆ˜ï¼ˆç¬¬2ç‰ˆï¼‰][book]ï¼Œæ¨ä¿åã€æˆ´ç‹å‰‘ã€æ›¹äºšä»‘ç¼–è‘—ï¼Œ2017å¹´3æœˆå‡ºç‰ˆï¼Œæœºæ¢°å·¥ä¸šå‡ºç‰ˆç¤¾
- [Docker Homepage][docker]
- [Docker Docs][docs]
- [Install Docker for Mac][install-docker-mac]
- [Get started with Docker for Mac][docker-for-mac]

[docker]: https://www.docker.com/
[docs]: https://docs.docker.com/
[cli-run]: https://docs.docker.com/engine/reference/commandline/run/
[cli-ps]: https://docs.docker.com/engine/reference/commandline/ps/
[book]: https://book.douban.com/subject/28489095/
[hub]: https://hub.docker.com
[docker-for-mac]: https://docs.docker.com/docker-for-mac/
[install-docker-mac]: https://docs.docker.com/docker-for-mac/install/